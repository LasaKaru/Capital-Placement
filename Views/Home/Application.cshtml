
@{
    ViewData["Title"] = "Application";
}


<div>
    <div class="container mt-5">
        <div class="row justify-content-center">
            <div class="col-md-6">
                <div class="paper-card">
                    <div class="rounded p-2 bg-black text-white">
                        <h5 class="text-left mb-6">Personal Information</h5>
                    </div>
                    <form id="applicationForm">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group mb-3">
                                    <!-- Added mb-3 class for margin bottom -->
                                    <label for="firstName"><b>First Name</b></label>
                                    <input type="text" class="form-control" id="firstName" name="firstName" placeholder="Type here" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group mb-3">
                                    <!-- Added mb-3 class for margin bottom -->
                                    <label for="lastName"><b>Last Name</b></label>
                                    <input type="text" class="form-control" id="lastName" name="lastName" placeholder="Type here" required>
                                </div>
                            </div>
                        </div>
                        <div class="form-group mb-3">
                            <!-- Added mb-3 class for margin bottom -->
                            <label for="email"><b>Email</b></label>
                            <input type="email" class="form-control" id="email" name="email" placeholder="Type here" required>
                        </div>
                        <div class="form-group mb-3">
                            <!-- Added mb-3 class for margin bottom -->
                            <label for="phone"><b>Phone</b> ( without dial code )</label>
                            <input type="tel" class="form-control" id="phone" name="phone" placeholder="Type here" required>
                        </div>
                        <div class="form-group mb-3">
                            <!-- Added mb-3 class for margin bottom -->
                            <label for="nationality"><b>Nationality</b></label>
                            <select class="form-control" id="nationality" name="nationality" placeholder="Select" required>
                                <option value="">Select</option>
                                <option value="USA">USA</option>
                                <!-- Add more options as needed -->
                            </select>
                        </div>
                        <div class="form-group mb-3">
                            <!-- Added mb-3 class for margin bottom -->
                            <label for="nationality"><b>Current Residence</b></label>
                            <select class="form-control" id="nationality" name="nationality" placeholder="Select" required>
                                <option value="">Select</option>
                                <option value="USA">USA</option>
                                <!-- Add more options as needed -->
                            </select>
                        </div>
                        <div class="form-group mb-3">
                            <!-- Added mb-3 class for margin bottom -->
                            <label for="phone"><b>ID Number</b></label>
                            <input type="tel" class="form-control" id="phone" name="phone" placeholder="Please type your number here" required>
                        </div>
                        <div class="form-group mb-3">
                            <!-- Added mb-3 class for margin bottom -->
                            <label for="dob"><b>Date of Birth</b></label>
                            <input type="date" class="form-control" id="dob" name="dob" placeholder="Select" required>
                        </div>
                        <div class="form-group mb-3">
                            <!-- Added mb-3 class for margin bottom -->
                            <label for="gender"><b>Gender</b></label>
                            <select class="form-control" id="gender" name="gender" placeholder="Select" required>
                                <option value="">Select Gender</option>
                                <option value="Male">Male</option>
                                <option value="Female">Female</option>
                                <option value="Other">Other</option> <!-- Fixed duplicate value -->
                            </select>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div class="container mt-5">
        <div class="row justify-content-center">
            <div class="col-md-6">
                <div class="paper-card">
                    <div class="rounded p-2 bg-black text-white">
                        <h5 class="text-left mb-6">Additional questions</h5>
                    </div>
                    <form id="applicationForm">
                        <div class="form-group mb-3">
                            <!-- Added mb-3 class for margin bottom -->
                            <label for="email"><b>Please tell me about yourself in less than 500 words</b></label>
                            <input type="email" class="form-control custom-input-size" id="email" name="email" placeholder="Please type your answer here" required>
                        </div>

                        <div class="form-group mb-3">
                            <!-- Added mb-3 class for margin bottom -->
                            <label for="gender"><b>Please select the year of graduation from the list below</b></label>
                            <select class="form-control" id="gender" name="gender" placeholder="other" required>
                                <option value="">Other</option>
                                <option value="Male">2024</option>
                                <option value="Female">2025</option>
                                <option value="Other">2026</option> <!-- Fixed duplicate value -->
                            </select>
                            <input type="tel" class="form-control" id="phone" name="phone" placeholder="Please specify Other" required>
                        </div>

                        <div class="form-group mb-3">
                            <!-- Added mb-3 class for margin bottom -->
                            <label for="keywords"><b>Multiple choice: Please select at least 2 answers from the dropdowns below.:</b></label>
                            <input type="text" class="form-control" id="keywords" name="keywords" placeholder="Please enter keywords separated by commas" required>
                        </div>
                        <div class="form-group mb-3">
                            <!-- Added mb-3 class for margin bottom -->
                            <label for="ukEmbassyRejection"><b>Have you ever been rejected by the UK embassy?</b></label><br>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="radio" name="ukEmbassyRejection" id="ukEmbassyRejectionYes" value="yes">
                                <label class="form-check-label" for="ukEmbassyRejectionYes">Yes</label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="radio" name="ukEmbassyRejection" id="ukEmbassyRejectionNo" value="no">
                                <label class="form-check-label" for="ukEmbassyRejectionNo">No</label>
                            </div>
                        </div>
                        <div class="form-group mb-3">
                            <!-- Added mb-3 class for margin bottom -->
                            <label for="phone"><b>How many years of experience do you have, please enter the number below</b></label>
                            <input type="tel" class="form-control" id="phone" name="phone" placeholder="Please type your number here" required>
                        </div>
                        <div class="form-group mb-3">
                            <!-- Added mb-3 class for margin bottom -->
                            <label for="dob"><b>Please provide the date that you have moved to the UK</b></label>
                            <input type="date" class="form-control" id="dob" name="dob" placeholder="Select the date" required>
                        </div>

                    </form>
                    <div class="form-group mb-3 d-flex justify-content-end">
                        <!-- Added d-flex and justify-content-end classes for flexbox alignment -->
                        <button type="submit" class="btn btn-primary btn-custom-width" style="background-color: rgb(0, 0, 0); color: white;">Submit Application</button>
                    </div>
                </div>
            </div>
        </div>
    </div>





    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const form = document.getElementById("applicationForm");

            form.addEventListener("submit", async function (event) {
                event.preventDefault(); // Prevent the default form submission

                // Collect form data
                const formData = new FormData(form);
                const data = Object.fromEntries(formData.entries());

                // Basic validation (you can add more validation as needed)
                if (!data.firstName || !data.lastName || !data.email || !data.phone) {
                    alert("Please fill in all required fields.");
                    return;
                }

                // Prepare data for API
                const programDTO = {
                    title: "Application Form",
                    description: "User submitted application form data",
                    questions: [
                        { text: `First Name: ${data.firstName}`, type: "text" },
                        { text: `Last Name: ${data.lastName}`, type: "text" },
                        { text: `Email: ${data.email}`, type: "email" },
                        { text: `Phone: ${data.phone}`, type: "tel" },
                        { text: `Nationality: ${data.nationality}`, type: "select" },
                        { text: `Current Residence: ${data.currentResidence}`, type: "select" },
                        { text: `ID Number: ${data.idNumber}`, type: "tel" },
                        { text: `Date of Birth: ${data.dob}`, type: "date" },
                        { text: `Gender: ${data.gender}`, type: "select" },
                        { text: `About Yourself: ${data.aboutYourself}`, type: "text" },
                        { text: `Year of Graduation: ${data.yearOfGraduation}`, type: "select" },
                        { text: `UK Embassy Rejection: ${data.ukEmbassyRejection}`, type: "radio" },
                        { text: `Years of Experience: ${data.yearsOfExperience}`, type: "tel" },
                        { text: `Moved to UK Date: ${data.movedToUkDate}`, type: "date" },
                        { text: `Keywords: ${data.keywords}`, type: "text" }
                    ]
                };

                try {
                    // Send data to the backend API
                    const response = await fetch("/api/programs", {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json"
                        },
                        body: JSON.stringify(programDTO)
                    });

                    if (response.ok) {
                        alert("Application submitted successfully!");
                        form.reset(); // Reset the form
                    } else {
                        alert("Failed to submit application.");
                    }
                } catch (error) {
                    console.error("Error submitting application:", error);
                    alert("An error occurred. Please try again.");
                }
            });
        });
    </script>








    @section Scripts {
        <script>
            // Handle form submission
            document.getElementById('applicationForm').addEventListener('submit', function (event) {
                event.preventDefault(); // Prevent the default form submission
                // Get form data
                const formData = new FormData(this);
                // Convert form data to JSON
                const jsonObject = {};
                for (const [key, value] of formData.entries()) {
                    jsonObject[key] = value;
                }
                // Send POST request with JSON data to the server
                fetch('/api/CandidateApplication', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(jsonObject)
                })
                    .then(response => {
                        if (!response.ok) {
                            throw new Error('Failed to submit application');
                        }
                        return response.json();
                    })
                    .then(data => {
                        // Handle successful submission
                        console.log('Application submitted successfully', data);
                        alert('Application submitted successfully');
                        // You can redirect the user to a thank you page or show a success message
                    })
                    .catch(error => {
                        // Handle errors
                        console.error('Error submitting application:', error.message);
                        alert('Error submitting application. Please try again.');
                    });
            });
        </script>




        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <script>
            $(document).ready(function () {
                $('#keywords').on('change', function () {
                    let keywords = $(this).val().split(',').map(keyword => keyword.trim());
                    $(this).val(keywords.join(', '));
                });
            });
        </script>
    }


